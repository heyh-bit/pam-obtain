name: Secure Information Transfer

on:
  push:
    branches:
      - main

jobs:
  generate_info:
    runs-on: ubuntu-latest

    outputs:
      secret_id: ${{ steps.generate.outputs.secret_id }}

    steps:
    - name: Generate Secret
      id: generate
      run: |
        MY_SECRET="my-sensitive-content"
        echo "MY_SECRET=$MY_SECRET" >> $GITHUB_ENV

    - name: Output Secret ID
      id: output
      run: |
        echo "::set-output name=secret_id::my-secret-id"
        
    - name: Output Secret ID
      id: output1
      run: |
        echo $GITHUB_ENV
    - name: Output Secret ID
      id: output2
      run: |
        echo $GITHUB_ENV

  use_info:
    needs: generate_info
    runs-on: ubuntu-latest
    env:
      MY_SECRET: ${{ secrets.MY_SECRET }}

    steps:
    - name: Use Secret
      run: |
        # 使用 MY_SECRET 变量，但不直接打印
        echo "Using MY_SECRET"
    - name: Output Secret ID
      id: output2
      run: |
        echo $GITHUB_ENV
